---
sidebar_label: InfluxDB
title: “InfluxDB”数据源
description: 使用“InfluxDB”数据源导入数据到 TDengine Cloud 的实例
---

InfluxDB 数据写入，是通过连接代理把数据从 InfluxDB 服务器写入到当前选择的 TDengine Cloud 实例。

## 先决条件

- 创建一个空数据库来存储 InfluxDB 数据。更多信息，请参阅 [数据库](../../../programming/model/#create-database)。
- 确保连接代理运行在与 InfluxDB 服务器位于同一网络的机器上。更多信息，请参阅 [安装连接代理](../install-agent/)。

## 具体步骤

1. 在 TDengine Cloud 中，在左边菜单中打开 **数据写入** 页面，在 **数据源** 选项卡上，单击 **添加数据源**打开新增页面。在**名称**输入框里面填写这个数据源的名称，并选择 **InfluxDB** 类型，在**代理**选择框里面选择已经创建的代理，如果没有创建代理，请点击旁边的**创建新的代理**按钮去创建新代理。
2. 在**目标数据库**里面选择一个当前所在的 TDengine Cloud 实例里面的数据库作为目标数据库。
3. 在**连接协议**栏中，配置连接协议，可配置为 WS、WSS。
4. 在**服务器地址**输入框, 输入 InfluxDB 服务器的地址，可以输入 IP 地址或域名，此项为必填字段。
5. 在**端口**输入框, 输入 InfluxDB 服务器端口，默认情况下，InfluxDB 监听 8086 端口的 HTTP 请求和 8088 端口的 HTTPS 请求，此项为必填字段。
6. 在**认证**部分的可以点击**1.x 版本**和**2.x 版本**来切换不同版本的数据源的 InfluxDB 服务器版本，切换完版本后，可以在**版本**输入框里面填写具体的版本。如果是 2.x 版本的 InfluxDB，请在**组织 ID**输入框，输入将要同步的组织 ID，此项为必填字段; 然后在**令牌 Token**输入框，输入一个至少拥有读取这个组织 ID 下的指定 Bucket 权限的 Token, 此项为必填字段; 如果是 1.x 版本的 InfluxDB，请填入相应的用户名和密码。
7. 可以点击**连通性检查**, 检查 Cloud 实例 与 InfluxDB 服务之间是否可以连通。
8. 在**task**卡片，可以配置以下信息：

   - **桶 Bucket**输入框，输入一个需要同步的 Bucket，目前只支持同步一个 Bucket 至 TDengine 数据库，此项为必填字段；
   - 在**测量值 Measurements**选择框里面，可以另外选择需要同步的 Measurement，如果不选就是 Bucket 包含的 Measurements 全部同步。
   - 在**起始时间**项目下，通过点选选择一个同步数据的起始时间，起始时间使用 UTC 时间， 此项为必填字段;
   - 在**结束时间**项目下，当不指定结束时间时，将持续进行最新数据的同步；当指定结束时间时，将只同步到这个结束时间为止; 结束时间使用 UTC 时间，此项为可选字段
   - 在**每次读取的时间范围**输入框，配置连接器从源 InfluxDB 数据库中单次读取数据时的最大时间范围，这是一个很重要的参数，需要用户结合服务器性能及数据存储密度综合决定。如果范围过小，则同步任务的执行速度会很慢；如果范围过大，则可能因内存使用过高而导致 InfluxDB 数据库系统故障。
   - 在**延迟**输入框，为了消除乱序数据的影响，TDengine 总是等待这里指定的时长，然后才读取数据。

9. 在**高级选项**卡片，可以配置以下信息：
   - **日志级别** 配置连接器的日志级别，支持 error, warn, info, debug, trace 5 个级别，默认值为 info。
   - 在**最大读取并发数**配置连接器从源 InfluxDB 数据库中读取数据时的最大并发数，默认值为 50。
   - 在**最大写入并发数**配置连接器向目标 TDengine 数据库中写入数据时的最大并发数，默认值为 50。
   - 在**批次大小**配置连接器向目标 TDengine 数据库中写入数据时的最大批次大小，默认值为 5000。
10. 填写完成以上信息后，点击**新增**按钮，即可直接启动从 InfluxDB 到 TDengine Cloud 实例的数据同步。
